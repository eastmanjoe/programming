'################################################
'Property of Draker Laboratories
'
'################################################

Const NUM_OF_IPS = 10
Public ip_addr(NUM_OF_IPS) As String * 15 = {"10.11.50.10", "10.11.50.21", "10.11.50.53", "10.11.50.24", "10.11.50.56", "10.11.50.61", "10.11.50.23", "10.11.50.180", "166.143.29.138", "10.11.40.24"}
Public ip_addr_array_length As Long

Public ping_response_time(NUM_OF_IPS) As Float
Dim scan_counter As Long

Units ping_response_time = msec

Function PingDevice(ip_addr As String) As Float
  Const NUM_OF_PINGS = 10
  Dim ping_response_time As Float = 0
  Dim counter
  'ping_time_out is in milliseconds
  Dim ping_time_out As Long = 1000


  For counter = 1 To NUM_OF_PINGS
    ping_response_time += PingIP(ip_addr, ping_time_out)
  Next

  Return ping_response_time / NUM_OF_PINGS
EndFunction

BeginProg
    Scan (60,Sec,3,0)

      For scan_counter = 1 to ArrayLength(ping_response_time)
        ping_response_time = 0
      Next

      For scan_counter = 1 to ArrayLength(ip_addr)
        ping_response_time(scan_counter) = PingDevice(ip_addr(scan_counter))
      Next

      ip_addr_array_length = ArrayLength(ip_addr)

    NextScan
EndProg
